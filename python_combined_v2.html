<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Python Мини IDE</title>
</head>
<body style="font-family:sans-serif;background:#f5f5f5;margin:0;padding:10px;">
  <h3>Редактор кода</h3>
  <textarea id="code" style="width:100%;height:180px;font-family:monospace;font-size:14px;border-radius:8px;padding:10px;border:1px solid #ccc;">print("Привет, мир!")</textarea>
  <br><br>
  <button onclick="runCode()" style="background:#007bff;color:white;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;">▶ Запустить</button>

  <h3 style="margin-top:20px;">Вывод программы:</h3>
  <pre id="output" style="background:#000;color:#0f0;padding:10px;border-radius:8px;min-height:100px;white-space:pre-wrap;"></pre>

  <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
  <script>
    async function init() {
      window.pyodide = await loadPyodide();
      console.log("Pyodide загружен!");
    }
    init();

    async function runCode() {
      const code = document.getElementById("code").value;
      const output = document.getElementById("output");
      output.textContent = "⏳ Выполнение...";

      try {
        const fullCode = `
import io, sys, contextlib
sys.stdout = io.StringIO()
try:
    exec(${JSON.stringify(code)})
except Exception as e:
    print("Ошибка:", e)
sys.stdout.getvalue()
`;

        const result = await pyodide.runPythonAsync(fullCode);
        output.textContent = result.trim() || "(нет вывода)";
      } catch (e) {
        output.textContent = "❌ Ошибка JS:\n" + e;
      }
    }
  </script>
</body>
</html>

